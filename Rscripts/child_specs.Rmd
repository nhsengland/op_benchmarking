`r paste0('# ', spec, ' {data-navmenu="specialities"}')`

## Column {data-width="1000"}

### `r paste0('Outpatient benchmarking metrics - ',spec)`

**Proof of concept prototype - all values are randomly generated**
```{r speciality table}

brks_4 <- quantile(spec_data$`SA Diversion Rate`, probs = seq(.05, .95, .05), na.rm = TRUE)
brks_5 <- quantile(spec_data$`Average Wait to OPFA`, probs = seq(.05, .95, .05), na.rm = TRUE)
brks_6 <- quantile(spec_data$`Discharge after OPFA`, probs = seq(.05, .95, .05), na.rm = TRUE)
brks_7 <- quantile(spec_data$`New:FU ratio`, probs = seq(.05, .95, .05), na.rm = TRUE)
brks_9 <- quantile(spec_data$`Missed Appointments`, probs = seq(.05, .95, .05), na.rm = TRUE)
brks_11 <- quantile(spec_data$`RTT Pathway Validation`, probs = seq(.05, .95, .05), na.rm = TRUE)

blu_clrs_4 <- round(seq(255, 40, length.out = length(brks_4) + 1), 0) %>%
  {paste0("rgb(",.,",",.,",255)")}
blu_clrs_5 <- round(seq(255, 40, length.out = length(brks_5) + 1), 0) %>%
  {paste0("rgb(",.,",",.,",255)")}
blu_clrs_6 <- round(seq(255, 40, length.out = length(brks_6) + 1), 0) %>%
  {paste0("rgb(",.,",",.,",255)")}
blu_clrs_7 <- round(seq(255, 40, length.out = length(brks_7) + 1), 0) %>%
  {paste0("rgb(",.,",",.,",255)")}
blu_clrs_11 <- round(seq(255, 40, length.out = length(brks_11) + 1), 0) %>%
  {paste0("rgb(",.,",",.,",255)")}

rd_clrs_9 <- round(seq(255, 40, length.out = length(brks_9) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}


datatable(spec_data,
          class = 'cell-border stripe',
          rownames = FALSE,
          options = list(pageLength = nrow(df),
                         paging = FALSE,
                         dom = 'ti')
) %>% 
  formatRound(c(5,7),1) %>% 
  formatPercentage(c(6,8,9,10,11),1) %>% 
  formatStyle(
    'SA per 100 OPFA',
    backgroundColor = styleInterval(c(16,20),c(table_red,table_amber,table_green))
  ) %>% 
  formatStyle(
    'SA Diversion Rate',
    backgroundColor = styleInterval(brks_4, blu_clrs_4)
  ) %>% 
  formatStyle(
    'Average Wait to OPFA',
    backgroundColor = styleInterval(brks_5, blu_clrs_5)
  ) %>% 
  formatStyle(
    'Discharge after OPFA',
    backgroundColor = styleInterval(brks_6, blu_clrs_6)
  ) %>% 
  formatStyle(
    'New:FU ratio',
    backgroundColor = styleInterval(brks_7, blu_clrs_7)
  ) %>% 
  formatStyle(
    'Moved or Discharged to PIFU',
    backgroundColor = styleInterval(c(0.045,0.05),c(table_red,table_amber,table_green))
  ) %>% 
  formatStyle(
    'Missed Appointments',
    backgroundColor = styleInterval(brks_9, rd_clrs_9)
  ) %>% 
  formatStyle(
    'OPFU Reduction',
    backgroundColor = styleInterval(c(-0.26,0.00),c(table_green,table_amber,table_red))
  ) %>% 
  formatStyle(
    'RTT Pathway Validation', 
    backgroundColor = styleInterval(brks_11, blu_clrs_11)
    )
```
